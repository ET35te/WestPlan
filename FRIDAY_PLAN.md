# 📅 周五计划 (Friday Tasks)

**日期**: 2026年1月2日 (周五)  
**目标**: 验证 + 优化 + 通关测试  
**预计工时**: 8 小时

---

## ☀️ 上午 (9:00 - 12:30) - 存档系统测试

### 任务 1: 保存功能验证

**目的**: 测试战斗中退出不丢数据

**步骤**:
```
1. 进入游戏 → 完成1个事件
2. 触发战斗，让战斗进行到第 2 回合
3. 记录此时的资源值:
   - Belief = X
   - Grain = Y
   - Armor = Z
4. 点击 "Menu" 或 "退出"
5. 在 Save/Load 界面，点击 "Save"
6. 看到 "保存成功" 提示
7. 关闭游戏 (File → Quit 或 Alt+F4)
```

**验证**:
- [ ] 保存文件是否生成? (路径: PlayerPrefs 或 PersistentDataPath)
- [ ] Console 中是否有错误?
- [ ] 是否出现 "保存成功" 的提示?

---

### 任务 2: 加载功能验证

**目的**: 测试读取之前保存的档案

**步骤**:
```
1. 重新打开游戏
2. 主菜单 → 点击 "继续游戏" (或 Load)
3. 游戏应该恢复到保存时的状态:
   - 节点位置相同
   - 资源值相同 (Belief/Grain/Armor)
   - 卡牌组合相同
   - 事件进度相同
4. 继续游戏，验证不卡顿
```

**验证**:
- [ ] 游戏是否正确加载?
- [ ] 资源值是否与保存时相同?
- [ ] 是否有数据损坏或混乱?

---

### 任务 3: 存档冲突测试

**目的**: 测试多个存档的独立性

**步骤**:
```
1. Save Slot 1: 进行到节点 3，保存
2. Save Slot 2: 进行到节点 5，保存
3. Load Slot 1: 检查是否正确回到节点 3
4. Load Slot 2: 检查是否正确回到节点 5
```

**验证**:
- [ ] 存档 1 和 2 是否完全独立?
- [ ] 是否有数据污染?

---

### 任务 4: 边界情况测试

**测试场景**:
- [ ] 保存在战斗胜利界面
- [ ] 保存在事件选择阶段
- [ ] 保存在节点结算界面
- [ ] 保存后立即加载 (同一次运行)
- [ ] 保存后关闭游戏再加载

**记录结果**: ☐ 全部通过 / ☐ 部分失败

---

## ☀️ 中午 (12:30 - 13:30) 午休 & 午评

**午评任务**:
```
□ 整理上午测试结果
□ 如有失败，列出修复优先级
□ 更新 DELIVERY_SUMMARY.md 中的进度
□ 拍照/录屏记录通过的场景
```

---

## ☀️ 下午 (13:30 - 18:00) - 胜利界面优化 & 通关测试

### 任务 5: 胜利界面战利品动画

**目的**: 实装战利品一个个弹出的视觉效果

**实现方案**:
```csharp
// 伪代码
public void ShowLootAnimation()
{
    // 1. 显示 "战利品获得!" 标题
    ShowTitle("战利品获得!");
    yield WaitForSeconds(0.5f);
    
    // 2. 一个个弹出战利品
    ShowLootItem("粮草 +2", 0.3f, Color.yellow);
    yield WaitForSeconds(0.5f);
    
    ShowLootItem("护甲 +1", 0.3f, Color.blue);
    yield WaitForSeconds(0.5f);
    
    // 3. 显示 "确认" 按钮
    ShowConfirmButton();
}
```

**检查清单**:
- [ ] 是否在 UIManager 中实装了该动画?
- [ ] 是否有适当的延迟以避免过快?
- [ ] 是否有音效反馈?

**代码修改**:
- [ ] 修改 UIManager.ShowLootPanel()
- [ ] 添加 Coroutine: IEnumerator ShowLootAnimation()
- [ ] 在 BattleManager 的 CheckVictoryCondition() 中调用

---

### 任务 6: 胜利界面细节优化

**优化清单**:

1. **信息完整性**
   - [ ] 显示击杀的敌人名字
   - [ ] 显示战斗耗时 (回合数)
   - [ ] 显示造成的总伤害
   - [ ] 显示获得的经验值 (如有)

2. **视觉反馈**
   - [ ] 背景淡入淡出
   - [ ] 战利品图标放大缩放
   - [ ] 数字滚动效果
   - [ ] 音效 + 音乐

3. **交互优化**
   - [ ] "确认" 按钮的高亮效果
   - [ ] 支持 Enter 键快速确认
   - [ ] 点击任意地方快速跳过动画 (可选)

**代码改动**:
```csharp
// BattleManager.cs 中的胜利结算部分
public void ShowVictoryScreen()
{
    // 1. 准备战利品数据
    int finalFood = stockFood + PlayerFood + VictoryLootFood;
    int finalArmor = stockArmor + PlayerArmor + VictoryLootArmor;
    
    // 2. 调用 UIManager 的优化胜利界面
    UIManager.Instance.ShowOptimizedVictoryScreen(new VictoryData
    {
        EnemyName = currentEnemyName,
        FinalFood = finalFood,
        FinalArmor = finalArmor,
        BattleTurns = turnCount,
        TotalDamage = totalDamageDone
    });
}
```

---

### 任务 7: 快速通关测试 (12个节点)

**目的**: 用 Debug 工具快速跑完全局，检查通关流程

**操作流程**:
```
1. 新游戏 → 启动
2. 对每个节点执行:
   a. 看到事件界面
   b. 随机选择选项 (或直接跳关)
   c. 如果触发战斗:
      - 按 Ctrl+I (资源无限)
      - 按 Ctrl+K (秒杀敌人)
      - 点击 "全军突击" (胜利)
   d. 确认，进入下一个节点
   
3. 完成所有 12 个节点 + 终焉

预计耗时: 20-30 分钟
```

**检查清单** (每个节点):
- [ ] 事件是否正确显示?
- [ ] 选项是否正确执行?
- [ ] 资源数据是否正确计算?
- [ ] 是否有崩溃或错误?

**节点列表**:
```
☐ 节点 1: 玉门关
☐ 节点 2: 白龙堆 (历史线) / 若羌 (幻想线)
☐ 节点 3: 楼兰 / 且末
☐ 节点 4: 龟兹 / 于阗
☐ 节点 5: 疏勒 / 莎车
☐ 节点 6: 天山 / 葱岭
☐ 节点 7: 车师 / 大宛
☐ 节点 8: 高昌 / 康居
☐ 节点 9: 敦煌 / 北匈奴
☐ 节点 10: 长安 / 单于庭
☐ 节点 11: 洛阳 / 封狼居胥
☐ 节点 12: 终焉
```

---

### 任务 8: 全局流程验证

**大版本测试** (完整通关一次):
```
1. 新游戏
2. 不使用 Debug，完整玩一遍
3. 观察所有流程是否顺畅:
   - 事件流程
   - 战斗流程
   - 结算流程
   - 节点推进
4. 记录任何卡顿或不合理的地方
5. 完成通关，查看结局画面
```

**验证点**:
- [ ] 是否出现黑屏/卡顿?
- [ ] 是否有数据计算错误?
- [ ] 是否有音乐/音效问题?
- [ ] 结局画面是否正确显示?

---

## 🌙 晚上 (18:00 - 20:00) - 问题修复 & 最终验证

### 任务 9: Bug 修复优先级

如果下午的测试发现了问题，按以下优先级修复:

**Tier 1 (Critical)** - 影响通关:
- [ ] 节点推进卡死
- [ ] 资源数据损坏
- [ ] 战斗无法进行

**Tier 2 (Important)** - 影响体验:
- [ ] 飘字显示异常
- [ ] 音效不播放
- [ ] UI 显示错误

**Tier 3 (Nice to have)** - 美化:
- [ ] 动画卡顿
- [ ] 颜色不对
- [ ] 位置偏移

---

### 任务 10: 最终验证签署

运行 VERIFICATION_CHECKLIST.md，填写所有验证项。

**目标**: 达到 95% 以上的通过率

**签署**:
```
日期: 2026年1月2日
通过率: ____%
状态: ☐ 可进行 Build ☐ 需继续修复
备注: _______________________
```

---

## 📊 周五完成标志

### 必成列表 (MUST DO)
- [x] 存档系统测试
- [x] 胜利界面优化
- [x] 通关流程验证

### 应成列表 (SHOULD DO)
- [x] 战利品动画实装
- [x] Debug 快速通关
- [x] 最终验证签署

### 可成列表 (NICE TO HAVE)
- [ ] 优化游戏速度
- [ ] 添加过场动画
- [ ] 完善声音设计

---

## 🚨 风险识别

| 风险 | 概率 | 影响 | 缓解方案 |
|------|------|------|---------|
| 存档系统崩溃 | 中 | 高 | 提前备份存档逻辑 |
| 战利品动画卡顿 | 中 | 中 | 使用 Coroutine 优化 |
| 通关卡在某个节点 | 低 | 高 | 逐节点调试 |
| 性能问题 | 低 | 中 | 使用 Profiler |

---

## 📅 时间分配

```
上午 (3.5 小时):
  - 任务 1-4 (存档测试): 3 小时
  - 记录&汇总: 0.5 小时

中午 (1 小时): 午休 + 午评

下午 (4.5 小时):
  - 任务 5-6 (胜利界面): 2 小时
  - 任务 7-8 (通关测试): 1.5 小时
  - 提交成果: 1 小时

晚上 (2 小时):
  - 任务 9-10 (修复&验证): 2 小时
```

---

## ✅ 下班前检查清单

```
□ 所有代码已提交
□ 最新版本已备份
□ 验证清单已填写
□ 测试视频/截图已保存
□ README 已更新
□ 周六计划已制定
□ 团队已通知进度
```

---

**目标**: 周五下班前，整个项目应该处于 **可 Build 状态**。

**衡量标准**:
- ✅ 无 Tier 1 Bug
- ✅ 通关流程完整
- ✅ 存档系统正常
- ✅ 验证清单 ≥95%

**失败条件**:
- ❌ 无法完整通关
- ❌ 存档丢失
- ❌ Tier 1 问题未解决

---

**生成**: 2026年1月1日  
**版本**: v1.0 Final  
**状态**: 📋 待执行
